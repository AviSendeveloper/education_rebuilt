(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"5Hjz":function(e,t,r){"use strict";r.d(t,"b",(function(){return O})),r.d(t,"c",(function(){return R})),r.d(t,"a",(function(){return U}));var n=r("o0o1"),o=r.n(n),c=r("rePB"),i=r("q1tI"),a=r.n(i),s=r("BOF4"),u=r.n(s),d=r("W3Qp"),l=r("vcXL"),f=r.n(l),p=r("yLiY");function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){Object(c.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var y=r.n(p)()().publicRuntimeConfig.ACCOUNTS_SERVICE_HOST;function v(e,t){var r;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.a.awrap(f()(y+e,b({mode:"cors",cache:"default",credentials:"include",headers:{"Content-Type":"application/json"}},t)));case 2:if((r=n.sent).ok){n.next=7;break}return n.next=6,o.a.awrap(r.json());case 6:throw n.sent;case 7:if(204!==r.status){n.next=9;break}return n.abrupt("return");case 9:return n.abrupt("return",r.json());case 10:case"end":return n.stop()}}))}var g,O,m,w,S={localAuth:function(e,t){return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",v("/auth/local",{method:"POST",body:JSON.stringify({username:e,password:t})}));case 1:case"end":return r.stop()}}))},googleAuth:function(e){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",v("/auth/google",{method:"POST",body:JSON.stringify({idToken:e})}));case 1:case"end":return t.stop()}}))},facebookAuth:function(e){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",v("/auth/facebook",{method:"POST",body:JSON.stringify({accessToken:e})}));case 1:case"end":return t.stop()}}))},refresh:function(e){var t;return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=null==e?void 0:{token:e},r.abrupt("return",v("/auth/refresh",{method:"POST",body:JSON.stringify(t)}));case 2:case"end":return r.stop()}}))},logout:function(e){var t;return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=null==e?void 0:{token:e},r.abrupt("return",v("/auth/logout",{method:"POST",body:JSON.stringify(t)}));case 2:case"end":return r.stop()}}))}},j=r("Ttos"),A=a.a.createElement;function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){Object(c.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e.RefreshRequest="ACCOUNT:REFRESH_REQUEST",e.RefreshSuccess="ACCOUNT:REFRESH_SUCCESS",e.RefreshFailure="ACCOUNT:REFRESH_FAILURE",e.RefreshUnauthorized="ACCOUNT:REFRESH_UNAUTHORIZED",e.LogoutRequest="ACCOUNT:LOGOUT_REQUEST",e.LogoutSuccess="ACCOUNT:LOGOUT_SUCCESS",e.LogoutFailure="ACCOUNT:LOGOUT_FAILURE",e.InitLocal="ACCOUNT:INIT_LOCAL",e.InitSession="ACCOUNT:INIT_SESSION",e.SetAge="ACCOUNT:SET_AGE"}(g||(g={})),function(e){e.Teacher="teacher",e.Parent="parent",e.Homeschool="homeschool"}(O||(O={})),function(e){e.Admin="admin",e.Premium="premium",e.SchoolAdmin="school-admin"}(m||(m={})),function(e){e.Google="google",e.Facebook="facebook"}(w||(w={}));var C={loading:!1,ready:!1,error:null,token:null,decoded:null,memberType:null,isAdmin:null,isPremium:null,isSchoolAdmin:null,isUnder13:null,otherAccounts:null},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.includes(O.Homeschool)?O.Homeschool:e.includes(O.Teacher)?O.Teacher:e.includes(O.Parent)?O.Parent:null},E=Object(d.b)((function(e,t){var r,n,o,c,i;switch(t.type){case g.RefreshRequest:case g.LogoutRequest:return P({},e,{loading:!0});case g.RefreshSuccess:return P({},e,{error:null,loading:!1,ready:!0,token:t.access_token,decoded:t.decoded,memberType:L(null===(r=t.decoded)||void 0===r?void 0:r.groups),isAdmin:null===(n=t.decoded)||void 0===n?void 0:n.roles.includes(m.Admin),isPremium:null===(o=t.decoded)||void 0===o?void 0:o.roles.includes(m.Premium),isSchoolAdmin:null===(c=t.decoded)||void 0===c?void 0:c.roles.includes(m.SchoolAdmin)});case g.RefreshFailure:return P({},e,{loading:!1,ready:!0,error:t.error});case g.RefreshUnauthorized:case g.LogoutSuccess:return P({},C,{loading:!1,ready:!0,otherAccounts:e.otherAccounts});case g.LogoutFailure:return P({},e,{error:t.error,loading:!1});case g.InitLocal:return P({},e,{otherAccounts:null!==(i=t.accounts)&&void 0!==i?i:[]});case g.InitSession:return P({},e,{},t.account,{isUnder13:t.isUnder13});case g.SetAge:return P({},e,{isUnder13:t.age<13});default:return e}})),R=Object(i.createContext)({}),U=function(e){var t,r,n=Object(i.useReducer)(E,C),c=n[0],a=n[1],s=function(){var e,t,r;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:g.RefreshRequest}),n.prev=1,n.next=4,o.a.awrap(S.refresh());case 4:e=n.sent,t=e.access_token,r=u()(t),Object(j.b)(t),a({type:g.RefreshSuccess,access_token:t,decoded:r}),n.next=15;break;case 11:throw n.prev=11,n.t0=n.catch(1),401===n.t0.status?(Object(j.d)(),a({type:g.RefreshUnauthorized})):(console.error(n.t0),a({type:g.RefreshFailure,error:n.t0})),n.t0;case 15:case"end":return n.stop()}}),null,null,[[1,11]])};Object(i.useEffect)((function(){!function(){var e=null;try{e=JSON.parse(window.sessionStorage.getItem("account"))}catch(r){}var t=null;/isUnder13\s*?=\s*?1/.test(document.cookie)?t=!0:/is13OrOlder\s*?=\s*?1/.test(document.cookie)&&(t=!1),a({type:g.InitSession,account:e,isUnder13:t})}(),s().catch((function(){})),Object(j.c)(s)}),[]),Object(i.useEffect)((function(){!function(){try{window.sessionStorage.setItem("account",JSON.stringify({decoded:c.decoded,memberType:c.memberType,isPremium:c.isPremium,isSchoolAdmin:c.isSchoolAdmin,otherAccounts:c.otherAccounts}))}catch(e){}}(),function(){var e;try{var t;e=null!==(t=JSON.parse(window.localStorage.getItem("accountInfo")))&&void 0!==t?t:[]}catch(s){e=[]}if(null!=c.decoded){var r,n,o,i={email:null===(r=c.decoded)||void 0===r?void 0:r.email,membershipType:c.isPremium?"pro":"basic",userType:c.memberType,socialSignupTypes:null!==(n=null===(o=c.decoded)||void 0===o?void 0:o.social)&&void 0!==n?n:[],dateLastLogin:(new Date).getTime()};(e=e.filter((function(e){return e.email!==i.email})).concat(i)).sort((function(e,t){return Object.prototype.hasOwnProperty.call(e,"dateLastLogin")||(e.dateLastLogin=0),Object.prototype.hasOwnProperty.call(t,"dateLastLogin")||(t.dateLastLogin=0),t.dateLastLogin-e.dateLastLogin}));try{window.localStorage.setItem("accountInfo",JSON.stringify(e))}catch(u){}}a({type:g.InitLocal,accounts:e})}()}),[c.decoded]);var d={error:c.error,loading:c.loading,ready:c.ready,memberType:c.memberType,isAdmin:c.isAdmin,isPremium:c.isPremium,isSchoolAdmin:c.isSchoolAdmin,isUnder13:c.isUnder13,otherAccounts:c.otherAccounts,memberId:null===(t=c.decoded)||void 0===t?void 0:t.sub,email:null===(r=c.decoded)||void 0===r?void 0:r.email,refresh:s,logout:function(){return o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return a({type:g.LogoutRequest}),e.prev=1,e.next=4,o.a.awrap(S.logout());case 4:Object(j.d)(),a({type:g.LogoutSuccess}),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),a({type:g.LogoutFailure,error:e.t0}),e.t0;case 12:case"end":return e.stop()}}),null,null,[[1,8]])},isType:function(e){var t,r;return null!==(t=null===c||void 0===c?void 0:null===(r=c.decoded)||void 0===r?void 0:r.groups.includes(e))&&void 0!==t&&t},setAge:function(e){a({type:g.SetAge,age:e})}};return A(R.Provider,{value:d},e.children)};U.displayName="AccountProvider"},BOF4:function(e,t,r){"use strict";var n=r("evrj");function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!==typeof e)throw new o("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(n(e.split(".")[r]))}catch(c){throw new o("Invalid token specified: "+c.message)}},e.exports.InvalidTokenError=o},Ttos:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return p})),r.d(t,"d",(function(){return h})),r.d(t,"c",(function(){return b}));var n,o,c=r("o0o1"),i=r.n(c),a=r("rePB"),s=r("vcXL"),u=r.n(s);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e){var t,r,c,a,s,d=arguments;return i.a.async((function(f){for(;;)switch(f.prev=f.next){case 0:if(t=d.length>1&&void 0!==d[1]?d[1]:{},r=!(d.length>2&&void 0!==d[2])||d[2],c=Object.assign({},t.headers,{"Content-Type":"application/json"}),"undefined"!==typeof n&&(c.Authorization="Bearer "+n),a=function(){return i.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",u()(e,l({},t,{headers:c})));case 1:case"end":return r.stop()}}))},r&&"function"===typeof o){f.next=7;break}return f.abrupt("return",a());case 7:return f.next=9,i.a.awrap(a());case 9:if(401!==(s=f.sent).status){f.next=22;break}return f.prev=11,f.next=14,i.a.awrap(o());case 14:f.next=19;break;case 16:return f.prev=16,f.t0=f.catch(11),f.abrupt("return",s);case 19:return f.next=21,i.a.awrap(a());case 21:s=f.sent;case 22:return f.abrupt("return",s);case 23:case"end":return f.stop()}}),null,null,[[11,16]])}function p(e){n=e}function h(){n=void 0}function b(e){o=e}},W3Qp:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n=r("yLiY");function o(e){return e}var c=r.n(n)()().publicRuntimeConfig.BRAINZY_TAB_DEBUG;function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/games/play/";if("true"===c)window.open(e);else{var t=screen.availHeight?screen.availHeight:screen.height,r=screen.availWidth?screen.availWidth:screen.width;t=t>1250?1250:t,r=r>1920?1920:r,t-=14,r-=14,window.open(e,"","scrollbars=no,menubar=no,location=no,status=no,toolbar=no,outerHeight="+t+",height="+t+",outerWidth="+r+",width="+r+",fullscreen=yes,left=0,top=0,resizable=yes").focus()}}},evrj:function(e,t,r){var n=r("m4GZ");e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(n(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(r){return n(t)}}},iuhU:function(e,t,r){"use strict";function n(e){var t,r,o="";if(e)if("object"===typeof e)if(e.push)for(t=0;t<e.length;t++)e[t]&&(r=n(e[t]))&&(o&&(o+=" "),o+=r);else for(t in e)e[t]&&(r=n(t))&&(o&&(o+=" "),o+=r);else"boolean"===typeof e||e.call||(o&&(o+=" "),o+=e);return o}t.a=function(){for(var e,t=0,r="";t<arguments.length;)(e=n(arguments[t++]))&&(r&&(r+=" "),r+=e);return r}},m4GZ:function(e,t){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function n(e){this.message=e}n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.exports="undefined"!==typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,c,i=0,a=0,s="";c=t.charAt(a++);~c&&(o=i%4?64*o+c:c,i++%4)?s+=String.fromCharCode(255&o>>(-2*i&6)):0)c=r.indexOf(c);return s}},rePB:function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,"a",(function(){return n}))},vcXL:function(e,t,r){"use strict";var n=self.fetch.bind(self);e.exports=n,e.exports.default=e.exports}}]);
//# sourceMappingURL=7adfda77f3041cfa1842b1234045aba6998118ae.c10dff6c34c19a43dbfb.js.map